<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Use the bulk API to prepare bulk format data — docs_bulk_prep • elastic</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Use the bulk API to prepare bulk format data — docs_bulk_prep" />

<meta property="og:description" content="Use the bulk API to prepare bulk format data" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">elastic</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/elastic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/search.html">UNKNOWN TITLE</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/ropensci/elastic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Use the bulk API to prepare bulk format data</h1>
    <small class="dont-index">Source: <a href='https://github.com/ropensci/elastic/blob/master/R/docs_bulk_prep.R'><code>R/docs_bulk_prep.R</code></a></small>
    <div class="hidden name"><code>docs_bulk_prep.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Use the bulk API to prepare bulk format data</p>
    
    </div>

    <pre class="usage"><span class='fu'>docs_bulk_prep</span>(<span class='no'>x</span>, <span class='no'>index</span>, <span class='no'>path</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>chunk_size</span> <span class='kw'>=</span> <span class='fl'>1000</span>,
  <span class='kw'>doc_ids</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>A data.frame or a list. required.</p></td>
    </tr>
    <tr>
      <th>index</th>
      <td><p>(character) The index name. required.</p></td>
    </tr>
    <tr>
      <th>path</th>
      <td><p>(character) Path to the file. If data is broken into chunks,
we'll use this path as the prefix, and suffix each file path with a number.
required.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>(character) The type name to use. If left as NULL, will be
same name as index.</p></td>
    </tr>
    <tr>
      <th>chunk_size</th>
      <td><p>(integer) Size of each chunk. If your data.frame is smaller
thank <code>chunk_size</code>, this parameter is essentially ignored. We write in
chunks because at some point, depending on size of each document, and
Elasticsearch setup, writing a very large number of documents in one go
becomes slow, so chunking can help. This parameter is ignored if you
pass a file name. Default: 1000</p></td>
    </tr>
    <tr>
      <th>doc_ids</th>
      <td><p>An optional vector (character or numeric/integer) of document
ids to use. This vector has to equal the size of the documents you are
passing in, and will error if not. If you pass a factor we convert to
character. Default: not passed</p></td>
    </tr>
    <tr>
      <th>quiet</th>
      <td><p>(logical) Suppress progress bar. Default: <code>FALSE</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>File path(s). By default we use temporary files; these are cleaned
up at the end of a session</p>
    
    <h2 class="hasAnchor" id="tempfiles"><a class="anchor" href="#tempfiles"></a>Tempfiles</h2>

    
    <p>In <code>docs_bulk</code> we create temporary files in some cases, and delete
those before the function exits. However, we don't clean up those files
in this function because the point of the function is to create the
newline delimited JSON files that you need. Tempfiles are cleaned up
when you R session ends though - be aware of that. If you want to
keep the files make sure to move them outside of the temp directory.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other bulk-functions: <code><a href='docs_bulk_create.html'>docs_bulk_create</a></code>,
  <code><a href='docs_bulk_delete.html'>docs_bulk_delete</a></code>,
  <code><a href='docs_bulk_index.html'>docs_bulk_index</a></code>,
  <code><a href='docs_bulk_update.html'>docs_bulk_update</a></code>, <code><a href='docs_bulk.html'>docs_bulk</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='co'># NOT RUN {</span>
<span class='co'># From a data.frame</span>
<span class='no'>ff</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>)
<span class='fu'>docs_bulk_prep</span>(<span class='no'>mtcars</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"hello"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"world"</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='no'>ff</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/readLines'>readLines</a></span>(<span class='no'>ff</span>)

<span class='co'>## field names cannot contain dots</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>iris</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/grep'>gsub</a></span>(<span class='st'>"\\."</span>, <span class='st'>"_"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/names'>names</a></span>(<span class='no'>iris</span>))
<span class='fu'>docs_bulk_prep</span>(<span class='no'>iris</span>, <span class='st'>"iris"</span>, <span class='st'>"flowers"</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))

<span class='co'>## type can be missing, but index can not</span>
<span class='fu'>docs_bulk_prep</span>(<span class='no'>iris</span>, <span class='st'>"flowers"</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))

<span class='co'># From a list</span>
<span class='fu'>docs_bulk_prep</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>iris</span>, <span class='fl'>1</span>, <span class='no'>as.list</span>), <span class='kw'>index</span><span class='kw'>=</span><span class='st'>"iris"</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"flowers"</span>,
   <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))
<span class='fu'>docs_bulk_prep</span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>USArrests</span>, <span class='fl'>1</span>, <span class='no'>as.list</span>), <span class='kw'>index</span><span class='kw'>=</span><span class='st'>"arrests"</span>,
   <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))

<span class='co'># when chunking</span>
<span class='co'>## multiple files created, one for each chunk</span>
<span class='no'>bigiris</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/do.call'>do.call</a></span>(<span class='st'>"rbind"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>replicate</a></span>(<span class='fl'>30</span>, <span class='no'>iris</span>, <span class='fl'>FALSE</span>))
<span class='fu'>docs_bulk_prep</span>(<span class='no'>bigiris</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"big"</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))

<span class='co'># When using in a loop</span>
<span class='co'>## We internally get last _id counter to know where to start on next bulk</span>
<span class='co'>## insert but you need to sleep in between docs_bulk_prep calls, longer the</span>
<span class='co'>## bigger the data is</span>
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test1.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test2.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test3.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>))
<span class='no'>paths</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/vector'>vector</a></span>(<span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>files</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_along</a></span>(<span class='no'>files</span>)) {
  <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='no'>files</span><span class='kw'>[[</span><span class='no'>i</span>]])
  <span class='no'>paths</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='fu'>docs_bulk_prep</span>(<span class='no'>d</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"stuff"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"docs"</span>,
     <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlist'>unlist</a></span>(<span class='no'>paths</span>)

<span class='co'># You can include your own document id numbers</span>
<span class='co'>## Either pass in as an argument</span>
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test1.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test2.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test3.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>))
<span class='no'>tt</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/lapply'>vapply</a></span>(<span class='no'>files</span>, <span class='kw'>function</span>(<span class='no'>z</span>) <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>NROW</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='no'>z</span>)), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/numeric'>numeric</a></span>(<span class='fl'>1</span>))
<span class='no'>ids</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='fl'>1</span>:<span class='no'>tt</span>[<span class='fl'>1</span>],
           (<span class='no'>tt</span>[<span class='fl'>1</span>] + <span class='fl'>1</span>):(<span class='no'>tt</span>[<span class='fl'>1</span>] + <span class='no'>tt</span>[<span class='fl'>2</span>]),
           (<span class='no'>tt</span>[<span class='fl'>1</span>] + <span class='no'>tt</span>[<span class='fl'>2</span>] + <span class='fl'>1</span>):<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sum'>sum</a></span>(<span class='no'>tt</span>))
<span class='no'>paths</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/vector'>vector</a></span>(<span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>files</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_along</a></span>(<span class='no'>files</span>)) {
  <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='no'>files</span><span class='kw'>[[</span><span class='no'>i</span>]])
  <span class='no'>paths</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='fu'>docs_bulk_prep</span>(<span class='no'>d</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"testes"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"docs"</span>,
    <span class='kw'>doc_ids</span> <span class='kw'>=</span> <span class='no'>ids</span><span class='kw'>[[</span><span class='no'>i</span>]], <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlist'>unlist</a></span>(<span class='no'>paths</span>)

<span class='co'>## or include in the input data</span>
<span class='co'>### from data.frame's</span>
<span class='no'>files</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test1_id.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test2_id.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>),
           <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"examples"</span>, <span class='st'>"test3_id.csv"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"elastic"</span>))
<span class='no'>paths</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/vector'>vector</a></span>(<span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>files</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_along</a></span>(<span class='no'>files</span>)) {
  <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='no'>files</span><span class='kw'>[[</span><span class='no'>i</span>]])
  <span class='no'>paths</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='fu'>docs_bulk_prep</span>(<span class='no'>d</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"testes"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"docs"</span>,
     <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlist'>unlist</a></span>(<span class='no'>paths</span>)

<span class='co'>### from lists via file inputs</span>
<span class='no'>paths</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/vector'>vector</a></span>(<span class='st'>"list"</span>, <span class='kw'>length</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/length'>length</a></span>(<span class='no'>files</span>))
<span class='kw'>for</span> (<span class='no'>i</span> <span class='kw'>in</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_along</a></span>(<span class='no'>files</span>)) {
  <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/read.table'>read.csv</a></span>(<span class='no'>files</span><span class='kw'>[[</span><span class='no'>i</span>]])
  <span class='no'>d</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/apply'>apply</a></span>(<span class='no'>d</span>, <span class='fl'>1</span>, <span class='no'>as.list</span>)
  <span class='no'>paths</span>[<span class='no'>i</span>] <span class='kw'>&lt;-</span> <span class='fu'>docs_bulk_prep</span>(<span class='no'>d</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"testes"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"docs"</span>,
      <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>))
}
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/unlist'>unlist</a></span>(<span class='no'>paths</span>)


<span class='co'># A mix of actions</span>
<span class='co'>## make sure you use a column named 'es_action' or this won't work</span>
<span class='co'>## if you need to delete or update you need document IDs</span>
<span class='kw'>if</span> (<span class='fu'><a href='indices.html'>index_exists</a></span>(<span class='st'>"baz"</span>)) <span class='fu'><a href='indices.html'>index_delete</a></span>(<span class='st'>"baz"</span>)
<span class='no'>df</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/data.frame'>data.frame</a></span>(<span class='kw'>a</span> <span class='kw'>=</span> <span class='fl'>1</span>:<span class='fl'>5</span>, <span class='kw'>b</span> <span class='kw'>=</span> <span class='fl'>6</span>:<span class='fl'>10</span>, <span class='kw'>c</span> <span class='kw'>=</span> <span class='no'>letters</span>[<span class='fl'>1</span>:<span class='fl'>5</span>], <span class='kw'>stringsAsFactors</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible</a></span>(<span class='fu'>docs_bulk_prep</span>(<span class='no'>df</span>, <span class='st'>"baz"</span>, <span class='no'>f</span>))
<span class='fu'><a href='cat.html'>cat</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/readLines'>readLines</a></span>(<span class='no'>f</span>), <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"\n"</span>)
<span class='fu'><a href='docs_bulk.html'>docs_bulk</a></span>(<span class='no'>f</span>)
(<span class='no'>res</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='Search.html'>Search</a></span>(<span class='st'>'baz'</span>, <span class='kw'>asdf</span><span class='kw'>=</span><span class='fl'>TRUE</span>)$<span class='no'>hits</span>$<span class='no'>hits</span>)

<span class='no'>df</span>[<span class='fl'>1</span>, <span class='st'>"a"</span>] <span class='kw'>&lt;-</span> <span class='fl'>99</span>
<span class='no'>df</span>[<span class='fl'>1</span>, <span class='st'>"c"</span>] <span class='kw'>&lt;-</span> <span class='st'>"aa"</span>
<span class='no'>df</span>[<span class='fl'>3</span>, <span class='st'>"c"</span>] <span class='kw'>&lt;-</span> <span class='fl'>33</span>
<span class='no'>df</span>[<span class='fl'>3</span>, <span class='st'>"c"</span>] <span class='kw'>&lt;-</span> <span class='st'>"cc"</span>
<span class='no'>df</span>$<span class='no'>es_action</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>'update'</span>, <span class='st'>'delete'</span>, <span class='st'>'update'</span>, <span class='st'>'delete'</span>, <span class='st'>'delete'</span>)
<span class='no'>df</span>$<span class='no'>id</span> <span class='kw'>&lt;-</span> <span class='no'>res</span>$<span class='no'>`_id`</span>
<span class='no'>df</span>
<span class='no'>f</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/invisible'>invisible</a></span>(<span class='fu'>docs_bulk_prep</span>(<span class='no'>df</span>, <span class='st'>"baz"</span>, <span class='kw'>path</span> <span class='kw'>=</span> <span class='no'>f</span>, <span class='kw'>doc_ids</span> <span class='kw'>=</span> <span class='no'>df</span>$<span class='no'>id</span>))
<span class='fu'><a href='cat.html'>cat</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/readLines'>readLines</a></span>(<span class='no'>f</span>), <span class='kw'>sep</span> <span class='kw'>=</span> <span class='st'>"\n"</span>)
<span class='fu'><a href='docs_bulk.html'>docs_bulk</a></span>(<span class='no'>f</span>)


<span class='co'># suppress progress bar</span>
<span class='fu'>docs_bulk_prep</span>(<span class='no'>mtcars</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"hello"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"world"</span>,
  <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>), <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'>## vs. </span>
<span class='fu'>docs_bulk_prep</span>(<span class='no'>mtcars</span>, <span class='kw'>index</span> <span class='kw'>=</span> <span class='st'>"hello"</span>, <span class='kw'>type</span> <span class='kw'>=</span> <span class='st'>"world"</span>,
  <span class='kw'>path</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/tempfile'>tempfile</a></span>(<span class='kw'>fileext</span> <span class='kw'>=</span> <span class='st'>".json"</span>), <span class='kw'>quiet</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>)
<span class='co'># }</span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#tempfiles">Tempfiles</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Scott Chamberlain.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

